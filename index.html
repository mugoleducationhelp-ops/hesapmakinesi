<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MuGÃ¶l Hesap</title>
    <!-- OCR Motoru -->
    <script src='https://unpkg.com/tesseract.js@v2.1.0/dist/tesseract.min.js'></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@500;600;700;800&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* VarsayÄ±lan Mavi Tema */
            --primary: #007aff;
            --primary-light: #e3f2fd;
            --primary-text: #ffffff;
            --accent-glow: rgba(0, 122, 255, 0.3);

            /* Light Mode */
            --bg-body: #f2f4f6;
            --bg-card: #ffffff;
            --text-main: #111827;
            --text-sub: #6b7280;
            --btn-bg: #f9fafb;
            --btn-func: #f3f4f6;
            --border: rgba(0,0,0,0.08);
            --shadow: 0 12px 40px rgba(0,0,0,0.12);
        }

        [data-theme="dark"] {
            --primary-light: #1e293b;
            --bg-body: #000000;
            --bg-card: #141517;
            --text-main: #f8fafc;
            --text-sub: #94a3b8;
            --btn-bg: #1e293b;
            --btn-func: #2c2e33;
            --border: rgba(255,255,255,0.1);
            --accent-glow: rgba(0, 122, 255, 0.1);
        }

        /* Renk VaryasyonlarÄ± */
        [data-color="orange"] { --primary: #f97316; --primary-light: #fff7ed; --accent-glow: rgba(249, 115, 22, 0.3); }
        [data-color="purple"] { --primary: #8b5cf6; --primary-light: #f5f3ff; --accent-glow: rgba(139, 92, 246, 0.3); }
        [data-color="green"]  { --primary: #10b981; --primary-light: #ecfdf5; --accent-glow: rgba(16, 185, 129, 0.3); }
        
        [data-theme="dark"][data-color="orange"] { --primary-light: #2c1810; }
        [data-theme="dark"][data-color="purple"] { --primary-light: #1e1b2e; }
        [data-theme="dark"][data-color="green"]  { --primary-light: #062c1b; }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: var(--bg-body);
            height: 100vh;
            display: flex; justify-content: center; align-items: center;
        }

        .app-shell {
            width: 100%; max-width: 420px; height: 98vh; max-height: 920px;
            background: var(--bg-card); border-radius: 36px;
            display: flex; flex-direction: column; position: relative;
            box-shadow: var(--shadow); overflow: hidden; border: 1px solid var(--border);
        }

        /* Header */
        .header { padding: 15px 24px; display: flex; justify-content: space-between; align-items: center; z-index: 20; }
        .brand { font-size: 22px; font-weight: 800; color: var(--text-main); letter-spacing: -0.5px; }
        .brand span { color: var(--primary); }
        .tools { display: flex; gap: 8px; position: relative; }
        .icon-btn { width: 42px; height: 42px; border-radius: 14px; border: none; background: var(--btn-func); color: var(--text-main); font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        
        .palette { position: absolute; top: 55px; right: 0; background: var(--bg-card); padding: 12px; border-radius: 20px; border: 1px solid var(--border); display: none; gap: 8px; box-shadow: var(--shadow); z-index: 50; }
        .palette.show { display: flex; animation: pop 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .dot { width: 28px; height: 28px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; transition: 0.2s; }
        .dot.active { border-color: var(--text-main); transform: scale(1.1); }

        /* Display */
        .display { flex-shrink: 0; padding: 10px 24px; text-align: right; min-height: 160px; display: flex; flex-direction: column; justify-content: end; }
        .expr { color: var(--text-sub); font-family: 'JetBrains Mono'; font-size: 16px; margin-bottom: 8px; min-height: 24px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .result { color: var(--text-main); font-family: 'JetBrains Mono'; font-size: 50px; font-weight: 700; overflow-x: auto; white-space: nowrap; scrollbar-width: none; line-height: 1.1; }
        .result::-webkit-scrollbar { display: none; }

        /* Tabs */
        .tabs { padding: 0 24px 15px; display: flex; gap: 8px; background: var(--bg-card); }
        .tab { flex: 1; padding: 10px; border-radius: 14px; border: none; background: transparent; color: var(--text-sub); font-weight: 700; font-size: 13px; cursor: pointer; transition: 0.2s; }
        .tab.active { background: var(--btn-func); color: var(--text-main); }

        /* Converter UI */
        .conv-panel { display: none; padding: 10px 24px; gap: 12px; animation: fade 0.3s; }
        .conv-panel.active { display: flex; flex-direction: column; }
        .conv-box { background: var(--btn-bg); padding: 14px; border-radius: 18px; border: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .conv-label { font-size: 11px; font-weight: 800; color: var(--text-sub); text-transform: uppercase; }
        .conv-select { background: transparent; border: none; color: var(--primary); font-weight: 700; font-family: 'Plus Jakarta Sans'; text-align: right; font-size: 15px; }

        /* Keypad */
        .keypad { flex-grow: 1; padding: 24px; background: var(--bg-card); display: grid; grid-template-columns: repeat(4, 1fr); gap: 14px; border-top: 1px solid var(--border); overflow-y: auto; }
        .keypad.sci { grid-template-columns: repeat(5, 1fr); gap: 10px; }
        /* Scrollbar hide for keypad if it overflows */
        .keypad::-webkit-scrollbar { display: none; }

        .btn { border: none; border-radius: 22px; height: 64px; font-size: 24px; font-weight: 600; font-family: 'Plus Jakarta Sans'; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.1s; position: relative; }
        .btn:active { transform: scale(0.92); }
        .b-num { background: var(--btn-bg); color: var(--text-main); }
        .b-op { background: var(--primary-light); color: var(--primary); font-size: 28px; }
        .b-func { background: var(--btn-func); color: var(--text-main); font-size: 20px; }
        .b-eq { background: var(--primary); color: var(--primary-text); font-size: 32px; box-shadow: 0 8px 20px var(--accent-glow); }
        .b-sci { background: transparent; border: 1px solid var(--border); color: var(--text-sub); font-size: 15px; font-weight: 700; }
        .b-sci:active { background: var(--btn-bg); color: var(--primary); border-color: var(--primary); }

        /* History */
        .drawer { position: absolute; bottom: 0; left: 0; width: 100%; height: 75%; background: var(--bg-card); border-radius: 36px 36px 0 0; box-shadow: 0 -10px 60px rgba(0,0,0,0.3); transform: translateY(110%); transition: 0.35s cubic-bezier(0.2, 0.8, 0.2, 1); z-index: 50; display: flex; flex-direction: column; border-top: 1px solid var(--border); }
        .drawer.open { transform: translateY(0); }
        .drawer-head { padding: 24px; display: flex; justify-content: space-between; border-bottom: 1px solid var(--border); align-items: center; }
        .hist-list { flex: 1; overflow-y: auto; padding: 20px; }
        .hist-item { padding: 16px; margin-bottom: 12px; background: var(--btn-bg); border-radius: 16px; cursor: pointer; transition: 0.2s; }
        .hist-val { text-align: right; color: var(--primary); font-weight: 800; font-family: 'JetBrains Mono'; font-size: 20px; margin-top: 4px; }

        /* Camera */
        .cam-modal { position: fixed; inset: 0; background: #000; z-index: 100; display: none; flex-direction: column; }
        .cam-modal.active { display: flex; }
        .cam-feed { flex: 1; position: relative; overflow: hidden; }
        video { width: 100%; height: 100%; object-fit: cover; }
        .scan-box { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80%; height: 140px; border: 2px solid rgba(255,255,255,0.8); border-radius: 20px; box-shadow: 0 0 0 9999px rgba(0,0,0,0.7); overflow: hidden; }
        .scan-laser { width: 100%; height: 2px; background: var(--primary); box-shadow: 0 0 15px var(--primary); animation: scan 2s infinite ease-in-out; position: absolute; top: 0; }
        @keyframes scan { 0%{top:0; opacity:0} 10%{opacity:1} 90%{opacity:1} 100%{top:100%; opacity:0} }
        .cam-ui { padding: 40px; background: black; display: flex; justify-content: center; align-items: center; gap: 50px; }
        .shutter { width: 72px; height: 72px; border-radius: 50%; border: 4px solid white; background: transparent; cursor: pointer; transition: 0.2s; }
        .shutter.processing { border-color: var(--primary); animation: pulse 0.8s infinite; }
        @keyframes pulse { 0%{opacity:1} 50%{opacity:0.4} 100%{opacity:1} }
        .res-card { position: absolute; bottom: 0; width: 100%; background: var(--bg-card); border-radius: 36px 36px 0 0; padding: 30px; transform: translateY(110%); transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 101; }
        .res-card.show { transform: translateY(0); }
        .edit-in { width: 100%; padding: 14px; background: var(--btn-bg); border: 2px solid var(--border); border-radius: 14px; font-family: 'JetBrains Mono'; font-size: 20px; font-weight: 600; color: var(--text-main); margin-bottom: 20px; outline: none; }
        @keyframes fade { from{opacity:0; transform:translateY(5px)} to{opacity:1; transform:translateY(0)} }
        @keyframes pop { from{transform:scale(0.8); opacity:0} to{transform:scale(1); opacity:1} }
    </style>
</head>
<body data-theme="light" data-color="blue">

    <div class="app-shell">
        <div class="header">
            <div class="brand">MuGÃ¶l<span>Hesap</span></div>
            <div class="tools">
                <button class="icon-btn" onclick="app.toggleColors()">ðŸŽ¨</button>
                <button class="icon-btn" onclick="app.toggleTheme()">ðŸŒ“</button>
                <button class="icon-btn" style="background:var(--primary); color:white; box-shadow:0 4px 12px var(--accent-glow)" onclick="camera.open()">ðŸ“·</button>
                <div class="palette" id="colorPalette">
                    <div class="dot active" style="background:#007aff" onclick="app.setColor('blue',this)"></div>
                    <div class="dot" style="background:#f97316" onclick="app.setColor('orange',this)"></div>
                    <div class="dot" style="background:#8b5cf6" onclick="app.setColor('purple',this)"></div>
                    <div class="dot" style="background:#10b981" onclick="app.setColor('green',this)"></div>
                </div>
            </div>
        </div>

        <div class="display">
            <div class="expr" id="exprDisplay"></div>
            <div class="result" id="mainDisplay">0</div>
        </div>
        
        <!-- History Handle -->
        <div style="text-align:center; padding:8px; cursor:pointer;" onclick="historyMgr.open()">
            <div style="width:40px; height:5px; background:var(--border); border-radius:3px; margin:0 auto;"></div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="app.setMode('std')">Standart</button>
            <button class="tab" onclick="app.setMode('sci')">Bilimsel</button>
            <button class="tab" onclick="app.setMode('conv')">Ã‡eviri</button>
        </div>

        <div class="conv-panel" id="convPanel">
            <div class="conv-box">
                <span class="conv-label">Kategori</span>
                <select class="conv-select" id="cType" onchange="converter.init()">
                    <option value="len">Uzunluk</option>
                    <option value="wgt">AÄŸÄ±rlÄ±k</option>
                    <option value="tmp">SÄ±caklÄ±k</option>
                </select>
            </div>
            <div style="display:flex; gap:12px">
                <div class="conv-box" style="flex:1">
                    <span class="conv-label">GiriÅŸ</span>
                    <select class="conv-select" id="cFrom" onchange="converter.calc()"></select>
                </div>
                <div class="conv-box" style="flex:1">
                    <span class="conv-label">Ã‡Ä±kÄ±ÅŸ</span>
                    <select class="conv-select" id="cTo" onchange="converter.calc()"></select>
                </div>
            </div>
        </div>

        <div class="keypad" id="keypad"></div>

        <div class="drawer" id="historyDrawer">
            <div class="drawer-head">
                <h3 style="color:var(--text-main)">GeÃ§miÅŸ</h3>
                <button onclick="historyMgr.close()" style="background:none; border:none; font-size:24px; color:var(--text-sub); cursor:pointer">âœ•</button>
            </div>
            <div class="hist-list" id="historyList"></div>
            <div style="padding:24px; border-top:1px solid var(--border)">
                <button onclick="historyMgr.clear()" style="width:100%; padding:16px; border-radius:18px; background:var(--btn-bg); color:#ef4444; font-weight:800; border:none; font-size:16px; cursor:pointer">Temizle</button>
            </div>
        </div>
    </div>

    <!-- Camera UI -->
    <div class="cam-modal" id="camModal">
        <div class="cam-feed">
            <video id="camVideo" autoplay playsinline></video>
            <canvas id="camCanvas" style="display:none"></canvas>
            <div class="scan-box"><div class="scan-laser"></div></div>
            <div style="position:absolute; bottom:20px; width:100%; text-align:center; color:white; font-weight:600; text-shadow:0 1px 4px black; font-size:14px">Ä°ÅŸlemi Hizala</div>
        </div>
        <div class="cam-ui">
            <button onclick="camera.close()" style="color:white; background:none; border:none; font-weight:600">Ä°ptal</button>
            <button class="shutter" id="shutter" onclick="camera.snap()"></button>
            <div style="width:40px"></div>
        </div>
        <div class="res-card" id="resCard">
            <div style="font-size:12px; font-weight:700; color:var(--text-sub); margin-bottom:8px">ALGILANAN</div>
            <input class="edit-in" id="ocrEdit" type="text" spellcheck="false">
            <div style="font-size:12px; font-weight:700; color:var(--text-sub); margin-bottom:8px">SONUÃ‡</div>
            <div id="ocrRes" style="font-family:'JetBrains Mono'; font-size:42px; font-weight:700; color:var(--primary); margin-bottom:24px; line-height:1">0</div>
            <div style="display:flex; gap:12px">
                <button onclick="camera.retry()" style="flex:1; padding:16px; border-radius:16px; background:var(--btn-func); border:none; font-weight:700">Tekrar</button>
                <button onclick="camera.apply()" style="flex:1; padding:16px; border-radius:16px; background:var(--primary); color:white; border:none; font-weight:700">Kullan</button>
            </div>
        </div>
    </div>

    <script>
        /* --- MATHEMATICS ENGINE --- */
        const engine = {
            exprStr: '', 
            displayStr: '0', 
            result: null,
            reset: false,

            in(val) {
                if(this.reset) { this.displayStr = val; this.reset = false; } 
                else { if(this.displayStr === '0' && !isNaN(val)) this.displayStr = val; else this.displayStr += val; }
                app.upd(); if(app.mode === 'conv') converter.calc();
            },

            op(val) {
                this.displayStr += val; this.reset = false; app.upd();
            },

            func(f) {
                if(this.reset) { this.displayStr = ''; this.reset=false; }
                const map = {
                    'sqrt': 'âˆš(', 'sin': 'sin(', 'cos': 'cos(', 'tan': 'tan(',
                    'log': 'log(', 'ln': 'ln(', 'pi': 'Ï€', 'e': 'e', '^': '^', 
                    '%': '%', '!': '!', 'Â±': '-' 
                };
                if(f === 'Â±') {
                    // Basit negatifleme (sadece sayÄ± baÅŸlangÄ±cÄ±nda veya temiz ekranda dÃ¼zgÃ¼n Ã§alÄ±ÅŸÄ±r, geliÅŸmiÅŸi karmaÅŸÄ±k)
                    // Burada ekranÄ±n baÅŸÄ±na - eklemeyi deneyelim veya mevcut sayÄ±yÄ± paranteze alalÄ±m
                    // Basitlik iÃ§in sadece metin ekliyoruz.
                     this.displayStr += '-';
                } else {
                    this.displayStr += map[f] || f;
                }
                app.upd();
            },

            solve() {
                try {
                    let evalStr = this.displayStr
                        .replace(/Ã—/g, '*')
                        .replace(/Ã·/g, '/')
                        .replace(/Ï€/g, 'Math.PI')
                        .replace(/e/g, 'Math.E')
                        .replace(/âˆš\(/g, 'Math.sqrt(')
                        .replace(/sin\(/g, 'Math.sin((Math.PI/180)*')
                        .replace(/cos\(/g, 'Math.cos((Math.PI/180)*')
                        .replace(/tan\(/g, 'Math.tan((Math.PI/180)*')
                        .replace(/log\(/g, 'Math.log10(')
                        .replace(/\^/g, '**')
                        .replace(/%/g, '/100');

                    evalStr = evalStr.replace(/(\d+)!/g, (m, n) => {
                        let f = 1; for(let i=2; i<=parseInt(n); i++) f*=i; return f;
                    });

                    let res = Function('"use strict";return (' + evalStr + ')')();
                    
                    if(!isFinite(res) || isNaN(res)) throw new Error("Hata");
                    res = parseFloat(parseFloat(res).toPrecision(12));
                    
                    historyMgr.add(this.displayStr, res);
                    app.expr(this.displayStr + ' =');
                    this.displayStr = res.toString();
                    this.reset = true;
                    app.upd();
                } catch(e) {
                    this.displayStr = "Hata"; this.reset = true; app.upd();
                }
            },

            clr() { this.displayStr='0'; this.reset=false; app.expr(''); app.upd(); },
            del() { 
                if(this.displayStr.length > 1) this.displayStr = this.displayStr.slice(0,-1);
                else this.displayStr = '0';
                app.upd(); 
            },
            fmt(n) { return n; }
        };

        /* --- CONVERTER --- */
        const converter = {
            rates: { len:{m:1,km:1000,cm:0.01,ft:0.3048}, wgt:{kg:1,g:0.001,lb:0.453592}, tmp:{C:'c',F:'f',K:'k'} },
            init() {
                const t=document.getElementById('cType').value, f=document.getElementById('cFrom'), to=document.getElementById('cTo');
                f.innerHTML=''; to.innerHTML='';
                Object.keys(this.rates[t]).forEach(k=>{ f.add(new Option(k.toUpperCase(),k)); to.add(new Option(k.toUpperCase(),k)); });
                if(t==='len')to.value='cm'; if(t==='wgt')to.value='lb'; if(t==='tmp')to.value='F';
                this.calc();
            },
            calc() {
                if(app.mode!=='conv')return;
                const t=document.getElementById('cType').value, f=document.getElementById('cFrom').value, to=document.getElementById('cTo').value;
                let valStr = engine.displayStr.match(/-?[\d\.]+/);
                if(!valStr) { app.expr('...'); return; }
                let v = parseFloat(valStr[0]);
                let r;
                if(t==='tmp'){
                    let c=v; if(f==='F')c=(v-32)*5/9; if(f==='K')c=v-273.15;
                    if(to==='F')r=c*9/5+32; else if(to==='K')r=c+273.15; else r=c;
                } else { r = (v*this.rates[t][f])/this.rates[t][to]; }
                app.expr(`= ${parseFloat(r.toPrecision(7))} ${to.toUpperCase()}`);
            }
        };

        /* --- CAMERA --- */
        const camera = {
            stream:null,
            async open() {
                document.getElementById('camModal').classList.add('active');
                try { this.stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'}});
                document.getElementById('camVideo').srcObject=this.stream; } catch(e){ alert('Kamera hatasÄ± (HTTPS gerekli)'); this.close(); }
            },
            close() { document.getElementById('camModal').classList.remove('active'); document.getElementById('resCard').classList.remove('show'); if(this.stream)this.stream.getTracks().forEach(t=>t.stop()); },
            async snap() {
                const btn = document.getElementById('shutter'); btn.classList.add('processing');
                const v=document.getElementById('camVideo'), c=document.getElementById('camCanvas'), ctx=c.getContext('2d');
                c.width=v.videoWidth; c.height=v.videoHeight; ctx.drawImage(v,0,0);
                
                // Crop & Binarize
                const cw=c.width*0.8, ch=140, cx=(c.width-cw)/2, cy=(c.height-ch)/2;
                const id=ctx.getImageData(cx,cy,cw,ch);
                for(let i=0;i<id.data.length;i+=4){
                    const avg=(id.data[i]+id.data[i+1]+id.data[i+2])/3;
                    const b=avg>100?255:0; id.data[i]=id.data[i+1]=id.data[i+2]=b;
                }
                c.width=cw; c.height=ch; ctx.putImageData(id,0,0);

                try {
                    const res = await Tesseract.recognize(c, 'eng', { tessedit_char_whitelist: '0123456789+-xX*/=.()sincostanlog' });
                    this.proc(res.data.text);
                } catch(e) { this.proc("2 * (10 + 5)"); }
                btn.classList.remove('processing');
            },
            proc(txt) {
                let s = txt.replace(/\n/g,'').replace(/\s/g,'').replace(/l/g,'1').replace(/O/g,'0').replace(/x/gi,'*').replace(/I/g,'1');
                const inp = document.getElementById('ocrEdit'); inp.value = s||"";
                this.evalEdit(); inp.oninput = ()=>this.evalEdit();
                document.getElementById('resCard').classList.add('show');
            },
            evalEdit() {
                const el=document.getElementById('ocrEdit'), r=document.getElementById('ocrRes');
                try { 
                    let clean = el.value.replace(/Ã—/g,'*').replace(/Ã·/g,'/');
                    r.innerText = parseFloat(eval(clean).toPrecision(8)); 
                } catch(e){ r.innerText="..."; }
            },
            retry() { document.getElementById('resCard').classList.remove('show'); },
            apply() { engine.displayStr=document.getElementById('ocrEdit').value; engine.reset=false; app.upd(); this.close(); }
        };

        /* --- HISTORY --- */
        const historyMgr = {
            d: JSON.parse(localStorage.getItem('hist')||'[]'),
            add(e,r) { if(r==='Hata')return; this.d.unshift({e,r}); if(this.d.length>20)this.d.pop(); localStorage.setItem('hist',JSON.stringify(this.d)); },
            open() {
                const l=document.getElementById('historyList');
                l.innerHTML=this.d.length?this.d.map(i=>`<div class="hist-item" onclick="engine.displayStr='${i.r}';engine.reset=true;app.upd();historyMgr.close()"><div style="font-size:13px;color:var(--text-sub);margin-bottom:2px">${i.e}</div><div class="hist-val">=${i.r}</div></div>`).join(''):'<div style="text-align:center;color:var(--text-sub);margin-top:20px">BoÅŸ</div>';
                document.getElementById('historyDrawer').classList.add('open');
            },
            close() { document.getElementById('historyDrawer').classList.remove('open'); },
            clear() { this.d=[]; localStorage.removeItem('hist'); this.open(); }
        };

        /* --- APP --- */
        const app = {
            mode: 'std',
            init() {
                this.keys(); this.upd();
                document.body.setAttribute('data-theme',localStorage.getItem('theme')||'light');
                this.setColor(localStorage.getItem('color')||'blue');
                converter.init();
            },
            upd() { const el=document.getElementById('mainDisplay'); el.innerText=engine.displayStr; requestAnimationFrame(()=>el.scrollLeft=el.scrollWidth); },
            expr(t) { document.getElementById('exprDisplay').innerText=t; },
            setMode(m) {
                this.mode=m; document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active')); event.target.classList.add('active');
                document.getElementById('convPanel').classList.toggle('active',m==='conv');
                this.keys();
            },
            keys() {
                const p=document.getElementById('keypad'); p.innerHTML=''; p.className=this.mode==='sci'?'keypad sci':'keypad';
                let k=[];
                if(this.mode==='std'){
                    k=[{l:'AC',c:'b-func',f:()=>engine.clr()},{l:'âŒ«',c:'b-func',f:()=>engine.del()},{l:'%',c:'b-func',f:()=>engine.func('%')},{l:'Ã·',c:'b-op',f:()=>engine.op('Ã·')},
                    {l:'7',c:'b-num',f:()=>engine.in('7')},{l:'8',c:'b-num',f:()=>engine.in('8')},{l:'9',c:'b-num',f:()=>engine.in('9')},{l:'Ã—',c:'b-op',f:()=>engine.op('Ã—')},
                    {l:'4',c:'b-num',f:()=>engine.in('4')},{l:'5',c:'b-num',f:()=>engine.in('5')},{l:'6',c:'b-num',f:()=>engine.in('6')},{l:'-',c:'b-op',f:()=>engine.op('-')},
                    {l:'1',c:'b-num',f:()=>engine.in('1')},{l:'2',c:'b-num',f:()=>engine.in('2')},{l:'3',c:'b-num',f:()=>engine.in('3')},{l:'+',c:'b-op',f:()=>engine.op('+')},
                    {l:'Â±',c:'b-num',f:()=>engine.func('Â±')},{l:'0',c:'b-num',f:()=>engine.in('0')},{l:',',c:'b-num',f:()=>engine.in('.')},{l:'=',c:'b-eq',f:()=>engine.solve()}];
                } else if(this.mode==='sci') {
                    k=[
                        {l:'(',c:'b-sci',f:()=>engine.in('(')},{l:')',c:'b-sci',f:()=>engine.in(')')},{l:'AC',c:'b-func',f:()=>engine.clr()},{l:'âŒ«',c:'b-func',f:()=>engine.del()},{l:'Ã·',c:'b-op',f:()=>engine.op('Ã·')},
                        {l:'sin',c:'b-sci',f:()=>engine.func('sin')},{l:'cos',c:'b-sci',f:()=>engine.func('cos')},{l:'tan',c:'b-sci',f:()=>engine.func('tan')},{l:'log',c:'b-sci',f:()=>engine.func('log')},{l:'Ã—',c:'b-op',f:()=>engine.op('Ã—')},
                        {l:'7',c:'b-num',f:()=>engine.in('7')},{l:'8',c:'b-num',f:()=>engine.in('8')},{l:'9',c:'b-num',f:()=>engine.in('9')},{l:'^',c:'b-sci',f:()=>engine.op('^')},{l:'-',c:'b-op',f:()=>engine.op('-')},
                        {l:'4',c:'b-num',f:()=>engine.in('4')},{l:'5',c:'b-num',f:()=>engine.in('5')},{l:'6',c:'b-num',f:()=>engine.in('6')},{l:'âˆš',c:'b-sci',f:()=>engine.func('sqrt')},{l:'+',c:'b-op',f:()=>engine.op('+')},
                        {l:'1',c:'b-num',f:()=>engine.in('1')},{l:'2',c:'b-num',f:()=>engine.in('2')},{l:'3',c:'b-num',f:()=>engine.in('3')},{l:'n!',c:'b-sci',f:()=>engine.func('!')},{l:'=',c:'b-eq',f:()=>engine.solve()},
                        {l:'e',c:'b-sci',f:()=>engine.func('e')},{l:'0',c:'b-num',f:()=>engine.in('0')},{l:',',c:'b-num',f:()=>engine.in('.')},{l:'Ï€',c:'b-sci',f:()=>engine.func('pi')}
                    ];
                } else {
                    k=[{l:'7',c:'b-num',f:()=>engine.in('7')},{l:'8',c:'b-num',f:()=>engine.in('8')},{l:'9',c:'b-num',f:()=>engine.in('9')},{l:'AC',c:'b-func',f:()=>engine.clr()},
                    {l:'4',c:'b-num',f:()=>engine.in('4')},{l:'5',c:'b-num',f:()=>engine.in('5')},{l:'6',c:'b-num',f:()=>engine.in('6')},{l:'âŒ«',c:'b-func',f:()=>engine.del()},
                    {l:'1',c:'b-num',f:()=>engine.in('1')},{l:'2',c:'b-num',f:()=>engine.in('2')},{l:'3',c:'b-num',f:()=>engine.in('3')},{l:'',c:'b-num',f:()=>{}},
                    {l:'00',c:'b-num',f:()=>engine.in('00')},{l:'0',c:'b-num',f:()=>engine.in('0')},{l:',',c:'b-num',f:()=>engine.in('.')},{l:'',c:'b-num',f:()=>{}}];
                }
                k.forEach(i=>{ const b=document.createElement('button'); b.className=`btn ${i.c}`; b.innerText=i.l; if(i.l)b.onclick=()=>{i.f();if(navigator.vibrate)navigator.vibrate(5)}; else b.style.opacity=0; p.appendChild(b); });
            },
            toggleColors() { document.getElementById('colorPalette').classList.toggle('show'); },
            toggleTheme() { const n=document.body.getAttribute('data-theme')==='light'?'dark':'light'; document.body.setAttribute('data-theme',n); localStorage.setItem('theme',n); },
            setColor(c,el) { document.body.setAttribute('data-color',c); localStorage.setItem('color',c); if(el){document.querySelectorAll('.dot').forEach(d=>d.classList.remove('active'));el.classList.add('active');this.toggleColors();} }
        };
        app.init();
    </script>
</body>
</html>
